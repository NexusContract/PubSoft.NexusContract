# NexusContract æ¶æ„å¤§æ¸…æ´—â€”â€”137â†’12 çš„ç‰©ç†è„±æ°´é‡æ„
## "æœˆæœˆçº¢"å®ªæ³•é”šç‚¹ç¡®ç«‹æ–¹æ¡ˆ

> **æ‰§è¡Œæ—¶é—´ï¼š** 2026-01-11 ~ 2026-02-28ï¼ˆ8å‘¨å·¥ç¨‹ï¼‰  
> **ç›®æ ‡ï¼š** ä»æ•£ä¹±çš„ 137 æ¡å†³ç­– â†’ 12 æ¡ç‰©ç†ä¸»æƒé”šç‚¹  
> **æ ¸å¿ƒç†å¿µï¼š** ç‰©ç†å¯»å€ä¼˜å…ˆï¼Œåˆ é™¤æ‰€æœ‰"çŒœæµ‹"ä¸"å…¼å®¹"é€»è¾‘

---

## ğŸ—ºï¸ ç¬¬ä¸€éƒ¨åˆ†ï¼š12 æ¡æ ¸å¿ƒå®ªæ³•æ˜ å°„

| å®ªæ³•åºå· | æ ¸å¿ƒä¸»æƒåŸåˆ™ | ç‰©ç†çº¦æŸ | æ¶µç›–åŸå§‹å†³ç­–æ±  |
|---------|-----------|--------|---------------|
| **001** | **æ˜¾å¼å¥‘çº¦é”å®š** | Contract å¯åŠ¨å³å†»ç»“ï¼Œè¿è¡Œæ—¶é›¶åå°„éªŒè¯ | CF-001, SD-001, HYDRATE-004, VALIDATE-002, NXC106, ARCH-ISV-001 |
| **002** | **URL èµ„æºå¯»å€** | ProfileId ä» HTTP è·¯å¾„/Body æ˜¾å¼ç»™å®šï¼Œç¦æ­¢çŒœæµ‹ | DECOUPLE-002, ARCH-ISV-002, ADAPT-HTTP-001, PIPELINE-003 |
| **003** | **ç‰©ç†æ§½ä½éš”ç¦»** | Provider:ProfileId å”¯ä¸€å¯»å€ï¼ŒRealm ä»…å®¡è®¡ | ISO-003, MT-002, ARCH-ISV-003, CONFIG-MEMORY-002, RESOLVER-005 |
| **004** | **BFF/Gate èŒè´£æ‹†åˆ†** | BFF è´Ÿè´£èº«ä»½->ProfileId è½¬æ¢ï¼ŒGate ä»…è´Ÿè´£æ‰§è¡Œ | DECOUPLE-001, ADR-010, MT-001, MT-CONTEXT-001, ROADMAP-001 |
| **005** | **çƒ­è·¯å¾„è„±ç½‘è‡ªæ²»** | L1 ç¼“å­˜+30å¤©ç»å¯¹è¿‡æœŸï¼Œæ”¯æ’‘ Redis å®Œå…¨ç¦»çº¿ | CS-002, CS-003, RESOLVER-001, ADR-015, REDIS-001, RESOLVER-004 |
| **006** | **å¯åŠ¨æœŸå…¨é‡ä½“æ£€** | å¯åŠ¨æˆåŠŸ âŸº æ‰€æœ‰ Contract å…ƒæ•°æ® FrozenDictionary å¯é  | CF-003, DIAG-002, VALIDATE-001, PIPELINE-002, ROADMAP-002 |
| **007** | **é›¶åå°„ IL å¼•æ“** | Projection/Hydration å…¨èµ°ç¼–è¯‘æœŸ ILï¼Œæ— è¿è¡Œæ—¶åå°„ | ED-003, ED-005, HYDRATE-001, ARCH-ISV-001, HYDRATE-001 |
| **008** | **å››é˜¶æ®µåŸå­ç®¡é“** | Validate â†’ Project â†’ Execute â†’ Hydrateï¼Œå„é˜¶æ®µç‹¬ç«‹å´©æºƒ | ED-002, GATEWAY-003, PIPELINE-001, HYDRATE-002, VALIDATE-003 |
| **009** | **Provider åè®®ä¸»æƒ** | å„ Provider ç‹¬ç«‹ç­¾åç®—æ³•ï¼Œæ¡†æ¶æ— æƒå¹²æ¶‰ | SD-002, ADAPTER-001, ADAPTER-ALIPAY-001, ROADMAP-001, ADAPTER-ALIPAY-002 |
| **010** | **Provider æ— çŠ¶æ€å•ä¾‹** | åŒä¸€ Provider æœåŠ¡æ‰€æœ‰ ProfileIdï¼Œé…ç½®ä»ç®¡é“å‚æ•°ä¼ å…¥ | ADAPTER-001, ARCH-ISV-004, ROADMAP-001, ARCH-ISV-001 |
| **011** | **ç‰ˆæœ¬åŒ–åŠ å¯†å­˜å‚¨** | ç§é’¥ Redis ä¸­ `v1:` å‰ç¼€ AES åŠ å¯†ï¼Œå†…å­˜ä¸­æ˜æ–‡é©»ç•™ | SD-003, SEC-AES-001, REDIS-003, RESOLVER-001 |
| **012** | **NXC ç»“æ„åŒ–è¯Šæ–­** | æ¯ä¸ªé”™è¯¯å¿…é¡»åœ¨å‘ç”Ÿé˜¶æ®µç«‹å³ç”Ÿæˆ NXC ç ï¼Œä¸å…è®¸æ±‡æ€»è½¬è¯‘ | DIAG-001, GATEWAY-005, VALIDATE-001, PIPELINE-001, HYDRATE-006 |

---

## ğŸ”¥ ç¬¬äºŒéƒ¨åˆ†ï¼šæ‰§è¡Œ"ä¸‰å±‚åˆ†ç±»"â€”â€”137 é¡¹å†³ç­–çš„å‘½è¿

### I. å½»åº•åˆ é™¤ï¼ˆProhibited/Deletedï¼‰â€”â€” 6 é¡¹"åŸç½ª"é€»è¾‘

è¿™äº›å†³ç­–ä»£è¡¨**æ¶æ„æ±¡æŸ“**ï¼Œå¿…é¡»ä»ä»£ç åº“å’Œè®­ç»ƒæ–‡æ¡£ä¸­ç‰©ç†æŠ¹é™¤ã€‚

#### ISO-001ï¼š500ms å†·å¯åŠ¨è¶…æ—¶ä¿æŠ¤
**åˆ é™¤ç†ç”±ï¼š**
- ç‰©ç†éš”ç¦»ï¼ˆå®ªæ³•003ï¼‰å·²è§£å†³ç«äº‰é—®é¢˜
- æ­¤é€»è¾‘æ˜¯**æˆ˜æœ¯å¦¥å**è€Œéæ¶æ„ä¸»æƒ
- `HybridConfigResolver.ColdStartSyncAsync()` ä¸­çš„è¶…æ—¶ä¿æŠ¤ä»£ç åº”å…¨éƒ¨åˆ é™¤
- **New Contractï¼š** æ–°å•†å®¶å¿…é¡»é€šè¿‡ BFF é¢„æ³¨å†Œï¼ŒGate ä¸å…è®¸å†·å¯åŠ¨å¤±è´¥

**æ‰§è¡Œæ­¥éª¤ï¼š**
```csharp
// âŒ DELETED
private async Task<HashSet<string>> ColdStartSyncAsync(...)
{
    using var cts = CancellationTokenSource.CreateLinkedTokenSource(ct);
    cts.CancelAfter(TimeSpan.FromMilliseconds(500));  // â† DELETE THIS
    
    try
    {
        await mapLock.WaitAsync(cts.Token);
    }
    catch (OperationCanceledException) when (cts.Token.IsCancellationRequested)
    {
        // â† DELETE THIS ENTIRE CATCH BLOCK
        throw new TimeoutException(...);
    }
}

// âœ… NEW
private async Task<HashSet<string>> LoadFromRedisAsync(string realmId, string providerName)
{
    // ç®€å•çš„ Redis æŸ¥è¯¢ï¼Œä¸æ”¯æŒå†·å¯åŠ¨
    var result = await _redis.SetMembersAsync(BuildMapKey(realmId, providerName));
    if (result.Length == 0)
        throw new NexusTenantException($"Realm {realmId} not found in Redis");
    return new HashSet<string>(result.Select(r => r.ToString()));
}
```

---

#### ADAPT-HTTP-001ï¼šå¤šæºèº«ä»½çŒœæµ‹ï¼ˆHeader/Body/Query æ¨¡ç³Šæå–ï¼‰
**åˆ é™¤ç†ç”±ï¼š**
- **æ˜¾å¼çº¦æŸ**ä¼˜äº**éšå¼çŒœæµ‹**ï¼ˆå®ªæ³•002ï¼‰
- TenantContextFactory ä¸­çš„"é­”æ³•"èº«ä»½æå–é€»è¾‘å¿…é¡»åˆ é™¤
- èº«ä»½åªèƒ½ä» **URL è·¯å¾„æ˜¾å¼ç»™å®š**

**æ‰§è¡Œæ­¥éª¤ï¼š**
```csharp
// âŒ DELETED
public class TenantContextFactory
{
    public static TenantContext FromHttpContext(HttpContext ctx)
    {
        // åˆ é™¤è¿™äº›çŒœæµ‹é€»è¾‘ï¼š
        // 1. ä» Header["X-SysId"] è¯»å–
        var sysId = ctx.Request.Headers["X-SysId"].ToString();  // â† DELETE
        
        // 2. ä» Body å‚æ•°çŒœæµ‹ AppId
        var appIdFromBody = req.AppId ?? req.SubMchId ?? ...;  // â† DELETE
        
        // 3. ä» Query å›é€€åˆ° Header
        var appId = ctx.Request.Query["app_id"] ?? ctx.Request.Headers["X-AppId"];  // â† DELETE
    }
}

// âœ… NEW
public class TenantContextFactory
{
    /// <summary>
    /// ä» URL è·¯å¾„æ˜¾å¼æå– ProfileId
    /// ä¾‹å¦‚ï¼šPOST /merchants/{merchantId}/trade/pay
    /// </summary>
    public static TenantContext FromUrlPath(HttpContext ctx, string profileId, string providerName)
    {
        return new TenantContext
        {
            ProviderName = providerName,  // ä»è·¯ç”±å…ƒæ•°æ®è¯»å–
            ProfileId = profileId,         // ä»è·¯å¾„å‚æ•°è¯»å–
            Metadata = new Dictionary<string, object>()
        };
    }
}
```

**æ”¹é€  Endpointï¼š**
```csharp
// OLD: æ¨¡ç³Šèº«ä»½æå–
public override async Task HandleAsync(TradePayRequest req, CancellationToken ct)
{
    var tenantCtx = TenantContextFactory.FromHttpContext(HttpContext);  // â† é­”æ³•
    var response = await _engine.ExecuteAsync(req, tenantCtx, ct);
}

// NEW: æ˜¾å¼è·¯å¾„å‚æ•°
public override async Task HandleAsync(TradePayRequest req, CancellationToken ct)
{
    var profileId = HttpContext.GetRouteValue("merchantId")?.ToString()
        ?? throw new BadHttpRequestException("Missing merchantId in URL");
    
    var tenantCtx = TenantContextFactory.FromUrlPath(HttpContext, profileId, "Alipay");
    var response = await _engine.ExecuteAsync(req, tenantCtx, ct);
}
```

---

#### MULTIAPP-001ï¼šé»˜è®¤ AppId å›é€€ç­–ç•¥
**åˆ é™¤ç†ç”±ï¼š**
- **æ˜¾å¼ä¼˜äºéšå¼**ï¼ˆå®ªæ³•002ï¼‰
- ç½‘å…³ä¸åº”çŒœæµ‹"å“ªä¸ª AppId æ˜¯é»˜è®¤çš„"
- æ¯ä¸ªè¯·æ±‚å¿…é¡»æ˜ç¡®æŒ‡å®š ProfileId

**æ‰§è¡Œæ­¥éª¤ï¼š**
```csharp
// âŒ DELETED
public async Task<ITenantIdentity> ResolveDefaultProfileAsync(ITenantIdentity identity)
{
    // å°è¯•è·å–é»˜è®¤ ProfileId æ ‡è®°
    string defaultMarker = $"{mapKey}:default";
    RedisValue defaultProfileId = await _redisDb.StringGetAsync(defaultMarker);
    
    if (defaultProfileId.HasValue)
        return new ConfigurationContext(...) { ProfileId = defaultProfileId.ToString() };
    
    // å¦‚æœæœªè®¾ç½®é»˜è®¤ï¼Œä» map ä¸­è·å–ç¬¬ä¸€ä¸ª ProfileId
    var allProfileIds = await _redisDb.SetMembersAsync(mapKey);
    var firstProfileId = allProfileIds[0];
    
    return new ConfigurationContext(...) { ProfileId = firstProfileId.ToString() };
}

// âœ… NEW: åˆ é™¤æ•´ä¸ªæ–¹æ³•ï¼ŒProfileId å¿…é¡»æ˜¾å¼ç»™å®š
// ResolveAsync(ITenantIdentity identity) ä¸­ï¼Œå¦‚æœ identity.ProfileId ä¸ºç©ºï¼Œç›´æ¥æŠ›å¼‚å¸¸
public async Task<IProviderConfiguration> ResolveAsync(ITenantIdentity identity, ...)
{
    if (string.IsNullOrEmpty(identity.ProfileId))
        throw new NexusTenantException(
            $"ProfileId is required. Realm '{identity.RealmId}' has no default AppId.");
    
    // ç›´æ¥åŠ è½½é…ç½®
    ...
}
```

---

#### CONFIG-MEMORY-003ï¼šæ–‡ä»¶çƒ­æ›´æ–°ç›‘æ§ï¼ˆFileSystemWatcherï¼‰
**åˆ é™¤ç†ç”±ï¼š**
- Redis Pub/Sub å·²æä¾›**åˆ†å¸ƒå¼ä¸€è‡´æ€§**ï¼ˆå®ªæ³•005ï¼‰
- æœ¬åœ°æ–‡ä»¶ç›‘æ§**å¼•å…¥ä¸ç¡®å®šæ€§**
- ä»…åœ¨ CI/CD ç¯èŠ‚æä¾›é…ç½®æ–‡ä»¶ï¼Œä¸åœ¨è¿è¡Œæ—¶çƒ­ä¿®æ”¹

**æ‰§è¡Œæ­¥éª¤ï¼š**
```csharp
// âŒ DELETED
public class HybridConfigResolver
{
    private readonly FileSystemWatcher _fileWatcher;  // â† DELETE THIS
    
    public HybridConfigResolver(...)
    {
        // ç›‘å¬é…ç½®æ–‡ä»¶å˜åŒ–
        _fileWatcher = new FileSystemWatcher("/config")  // â† DELETE
        {
            Filter = "*.json",
            NotifyFilter = NotifyFilters.LastWrite
        };
        _fileWatcher.Changed += OnConfigFileChanged;
    }
    
    private void OnConfigFileChanged(object sender, FileSystemEventArgs e)
    {
        // é‡æ–°åŠ è½½é…ç½®
        var config = LoadFromFile(e.FullPath);  // â† DELETE
        _redisDb.StringSetAsync(BuildCacheKey(...), JsonSerializer.Serialize(config));
    }
}

// âœ… NEW: ä»…æ”¯æŒ Redis Pub/Sub å’Œ Manual Refresh
public class HybridConfigResolver
{
    // FileSystemWatcher å®Œå…¨åˆ é™¤
    // é…ç½®å˜æ›´ä»…é€šè¿‡ï¼š
    // 1. Redis Pub/Sub (è‡ªåŠ¨)
    // 2. TenantConfigurationManager.UpdateAsync() (æ‰‹åŠ¨)
    
    public async Task RefreshAsync(ITenantIdentity identity, CancellationToken ct)
    {
        // æ¸…é™¤ L1ï¼Œç­‰å¾…ä¸‹æ¬¡è¯·æ±‚ä» Redis å›æº
        _memoryCache.Remove(BuildCacheKey(identity));
        await PublishRefreshNotificationAsync(identity);
    }
}
```

---

#### HYDRATE-001 L2ï¼šåå°„å›å¡«è·¯å¾„ï¼ˆFallback to Reflectionï¼‰
**åˆ é™¤ç†ç”±ï¼š**
- **å¯åŠ¨æœŸä½“æ£€**ï¼ˆå®ªæ³•006ï¼‰ç¡®ä¿æ‰€æœ‰ Contract ç¼–è¯‘æœŸ IL å®Œå…¨å¯é 
- è¿è¡Œæ—¶åå°„å›å¡«æ˜¯**é€ƒç”Ÿèˆ±å£**ï¼Œå¿…é¡»åˆ é™¤
- å¦‚æœ IL ç¼–è¯‘å¤±è´¥ï¼Œå¯åŠ¨å°±åº”è¯¥å¤±è´¥ï¼Œä¸å…è®¸é™çº§åˆ°åå°„

**æ‰§è¡Œæ­¥éª¤ï¼š**
```csharp
// âŒ DELETED
public class ResponseHydrationEngine
{
    public async Task<TResponse> HydrateAsync<TResponse>(
        Dictionary<string, object> responseDict)
        where TResponse : class, new()
    {
        try
        {
            // L1: å°è¯•ç¼–è¯‘æœŸ ILï¼ˆFastInvokerï¼‰
            var hydrator = _il GeneratedHydrators.GetOrAdd(typeof(TResponse), ...);
            return hydrator(responseDict) as TResponse;
        }
        catch
        {
            // âŒ DELETE THIS FALLBACK BLOCK
            // L2: é™çº§åˆ°åå°„ï¼ˆç¦æ­¢ï¼‰
            var instance = new TResponse();
            foreach (var prop in typeof(TResponse).GetProperties())
            {
                if (responseDict.TryGetValue(GetApiFieldName(prop), out var value))
                    prop.SetValue(instance, value);
            }
            return instance;
        }
    }
}

// âœ… NEW: å½»åº•åˆ é™¤ L2ï¼Œå¯åŠ¨å¤±è´¥å³å¤±è´¥
public class ResponseHydrationEngine
{
    public async Task<TResponse> HydrateAsync<TResponse>(
        Dictionary<string, object> responseDict)
        where TResponse : class, new()
    {
        // å¯åŠ¨æœŸå·²éªŒè¯æ‰€æœ‰ Contract å¯ç¼–è¯‘
        // è¿è¡Œæ—¶æ— éœ€ fallback
        var hydrator = _ilGeneratedHydrators[typeof(TResponse)]
            ?? throw new InvalidOperationException(
                $"Type {typeof(TResponse).Name} not precompiled during startup. " +
                "Run startup health check.");
        
        return hydrator(responseDict) as TResponse 
            ?? throw new InvalidOperationException("Hydration returned null");
    }
}
```

---

#### VER/CV ç³»åˆ—ï¼šç®¡ç†å…«è‚¡ï¼ˆç‰ˆæœ¬è·¯çº¿ã€é¡¹ç›®ä»·å€¼è§‚è™šè¯ï¼‰
**åˆ é™¤ç†ç”±ï¼š**
- è¿™äº›éƒ½æ˜¯**å…ƒå†³ç­–æ–‡æ¡£**è€Œé**æ¶æ„çº¦æŸ**
- ä»…ä¸ºäº†æ»¡è¶³"å†³ç­–è®°å½•"çš„è™šè£å¿ƒ
- åˆ é™¤ï¼šVER-001~004, CV-001~003

**å…·ä½“åˆ é™¤æ¸…å•ï¼š**
- âŒ VER-001 (ç‰ˆæœ¬æ¼”è¿›ç­–ç•¥)
- âŒ VER-002 (Preview â†’ RC â†’ GA é˜¶æ®µ)
- âŒ VER-003 (å‘å¸ƒæ¸ é“ä¸ç¨³å®šæ€§ä¿è¯)
- âŒ VER-004 (é•¿æœŸæ”¯æŒæ‰¿è¯º)
- âŒ CV-001 (é¡¹ç›®æ ¸å¿ƒä»·å€¼è§‚)
- âŒ CV-002 (è®¾è®¡å“²å­¦)
- âŒ CV-003 (å¼€å‘è€…ä½“éªŒæ„¿æ™¯)

**ä¿ç•™ï¼š** ä»…ä¿ç•™ ROADMAP-004ï¼ˆç‰ˆæœ¬è¿›åŒ–äº‹å®æè¿°ï¼‰

---

### II. å¼ºåŠ›åˆå¹¶ï¼ˆMerged & Hardenedï¼‰â€”â€” 3 é¡¹æˆ˜æœ¯åˆå¹¶å…¥å®ªæ³•

#### åˆå¹¶ 1ï¼šé…ç½®å¯»å€ä¸‰å…ƒç»„ â†’ ProfileId å•å…ƒå¯»å€
**åˆå¹¶åŸå§‹å†³ç­–ï¼š**
- CONFIG-MEMORY-001 (L1/L2 ç»“æ„)
- CONFIG-MEMORY-002 (ç¼“å­˜é”®è®¾è®¡)
- MULTIAPP-003 (Redis æ•°æ®ç»“æ„)
- RESOLVER-005 (æƒé™ç´¢å¼•)

**æ–°ä¸»æƒçº¦æŸï¼š**
```csharp
// âŒ OLD: ä¸‰å…ƒç»„ (Provider, Realm, Profile)
string cacheKey = $"{ctx.ProviderName}:{ctx.RealmId}:{ctx.ProfileId}";
var config = await resolver.ResolveAsync(new ConfigurationContext(
    providerName: "Alipay",
    realmId: "2088...",
    profileId: "2021..."
));

// âœ… NEW: ProfileId å•å…ƒå¯»å€ï¼ˆRealm ä»…å®¡è®¡ï¼‰
string cacheKey = $"config:{profileId}";  // O(1) ç‰©ç†ç´¢å¼•
var config = await resolver.ResolveAsync(
    providerName: "Alipay",
    profileId: profileId  // â† å”¯ä¸€å¯»å€é”®
);

// Redis æ•°æ®ç»“æ„ç®€åŒ–ï¼š
// BEFORE: Hash (nxc:map:realm:provider) å­˜å‚¨æƒé™ç´¢å¼•
// AFTER: ç›´æ¥ä½¿ç”¨ profileId ä½œä¸º Keyï¼Œæ— éœ€æƒé™ç´¢å¼•å±‚
//        æƒé™ç®¡ç†ç”± BFF è´Ÿè´£ï¼ˆèº«ä»½ â†’ ProfileId è½¬æ¢ï¼‰
```

**ç‰©ç†çº¦æŸï¼š**
- Realm ä»…ä¿ç•™åœ¨**å®¡è®¡æ—¥å¿—**ä¸­ï¼ˆ"è¯¥è¯·æ±‚æ¥è‡ª Realm X"ï¼‰
- å¯»å€é€»è¾‘ä¸ä¾èµ– Realmï¼ˆå³ä½¿ä¸¢å¤±ä¹Ÿèƒ½ç»§ç»­è¿è¡Œï¼‰
- Redis Key ç©ºé—´ï¼š`config:{provider}:{profileId}`

---

#### åˆå¹¶ 2ï¼šå®‰å…¨ä¸»æƒç»Ÿä¸€åŒ–ï¼ˆåŠ å¯†ç®—æ³• + å­˜å‚¨ç­–ç•¥ï¼‰
**åˆå¹¶åŸå§‹å†³ç­–ï¼š**
- SEC-AES-001 (AES256 åŠ å¯†)
- REDIS-003 (åŠ å¯†å­˜å‚¨)
- RESOLVER-001 (L1/L2 ç¼“å­˜)

**æ–°ä¸»æƒçº¦æŸï¼š**
```csharp
// å®ªæ³• 011ï¼šç‰ˆæœ¬åŒ–åŠ å¯†å­˜å‚¨

public interface ISecurityProvider
{
    /// <summary>
    /// ç§é’¥åŠ å¯†ï¼ˆå†™å…¥ Redisï¼‰
    /// - ç®—æ³•ï¼šAES256-CBC
    /// - IVï¼šæ¯æ¬¡éšæœºç”Ÿæˆ
    /// - ç‰ˆæœ¬å‰ç¼€ï¼šv1: æ”¯æŒæœªæ¥å‡çº§
    /// è¿”å›ï¼šv1:base64_encrypted
    /// </summary>
    string EncryptPrivateKey(string plaintext);
    
    /// <summary>
    /// ç§é’¥è§£å¯†ï¼ˆä» Redis è¯»å–ï¼‰
    /// - è‡ªåŠ¨è¯†åˆ«ç‰ˆæœ¬å‰ç¼€ï¼ˆv1:, v2: ...)
    /// - è¿”å›ï¼šçº¯æ–‡æœ¬ PEM
    /// </summary>
    string DecryptPrivateKey(string encrypted);
}

// æ‰§è¡Œç­–ç•¥ï¼š
// 1. Redis ä¸­ï¼šPrivateKey = "v1:aGVs..." (AESåŠ å¯†)
// 2. å†…å­˜ä¸­ï¼šProviderSettings.PrivateKey = "MIIEvQ..." (æ˜æ–‡)
// 3. ä¼ è¾“ä¸­ï¼š[æ— ] (ä¸è·¨ç½‘ç»œ)

public class ProviderSettings
{
    public string ProviderName { get; set; }
    public string AppId { get; set; }
    public string PrivateKey { get; set; }  // å†…å­˜ä¸­å§‹ç»ˆæ˜æ–‡
    public string PublicKey { get; set; }
}
```

**ç‰©ç†çº¦æŸï¼š**
- ç§é’¥**ç»ä¸å…è®¸**å†™å…¥æ—¥å¿—/ç¼“å­˜é”®/è¯Šæ–­æ¶ˆæ¯
- åŠ å¯†å¯†é’¥ç”±ç¯å¢ƒå˜é‡ `SECURITY_MASTER_KEY` æä¾›
- å¯†é’¥è½®æ¢é€šè¿‡ç‰ˆæœ¬å‰ç¼€ï¼ˆv1: â†’ v2:ï¼‰å®ç°ï¼Œæ— éœ€åº”ç”¨é‡å¯

---

#### åˆå¹¶ 3ï¼šå¯åŠ¨ä½“æ£€ + NXC è¯Šæ–­ç ç»Ÿä¸€åŒ–
**åˆå¹¶åŸå§‹å†³ç­–ï¼š**
- VALIDATE-001 (Contract éªŒè¯)
- VALIDATE-002 (NXC é”™è¯¯ç è®¾è®¡)
- PIPELINE-002 (å¯åŠ¨å¥åº·æ£€æŸ¥)
- DIAG-001/DIAG-002 (è¯Šæ–­ç³»ç»Ÿ)

**æ–°ä¸»æƒçº¦æŸï¼š**
```csharp
// å®ªæ³• 006 + 012 çš„ç»Ÿä¸€æ‰§è¡Œ

public interface INexusContractMetadataRegistry
{
    /// <summary>
    /// å¯åŠ¨æœŸé¢„çƒ­ï¼šæ‰«ææ‰€æœ‰ Contractï¼Œç¼–è¯‘ ILï¼Œç”Ÿæˆè¯Šæ–­æŠ¥å‘Š
    /// å¯åŠ¨æˆåŠŸ âŸº æ‰€æœ‰ Contract å…ƒæ•°æ® FrozenDictionary å¯é 
    /// </summary>
    DiagnosticReport Preload(Type[] contractTypes, bool warmup = true);
}

public class DiagnosticReport
{
    public bool HasCriticalErrors { get; set; }
    
    // NXC é”™è¯¯ç æ¸…å•
    public List<DiagnosticEntry> Entries { get; set; }
}

public class DiagnosticEntry
{
    public string NxcCode { get; set; }        // NXC101, NXC102 ...
    public string Message { get; set; }
    public int LineNumber { get; set; }
    public Type ContractType { get; set; }
}

// NXC ç èŒƒå›´åˆ†é…ï¼š
// NXC1xx: Contract éªŒè¯é”™è¯¯ï¼ˆå¯åŠ¨æœŸï¼‰
// NXC2xx: é…ç½®é”™è¯¯ï¼ˆè¿è¡Œæ—¶ï¼‰
// NXC3xx: ä¼ è¾“é”™è¯¯ï¼ˆExecute é˜¶æ®µï¼‰
// NXC4xx: ååºåˆ—åŒ–é”™è¯¯ï¼ˆHydrate é˜¶æ®µï¼‰
// NXC5xx: ç­¾åé”™è¯¯ï¼ˆProvider å±‚ï¼‰
// NXC99x: æ¡†æ¶å†…éƒ¨é”™è¯¯

// æ‰§è¡Œé€»è¾‘ï¼šæ¯ä¸ªé˜¶æ®µçš„é”™è¯¯å¿…é¡»åœ¨å‘ç”Ÿæ—¶ç«‹å³ç”Ÿæˆ NXC ç 
public async Task<TResponse> ExecuteAsync<TRequest, TResponse>(
    TRequest request, TenantContext context, CancellationToken ct)
    where TRequest : IApiRequest<TResponse>
{
    try
    {
        // Phase 1: Validate
        var metadata = _registry.GetMetadata(typeof(TRequest));
        var validationResult = _validator.Validate(request, metadata);
        if (!validationResult.IsValid)
        {
            // ç«‹å³ç”Ÿæˆ NXC101ï¼ˆContract éªŒè¯å¤±è´¥ï¼‰
            throw new ContractValidationException("NXC101", validationResult.Errors);
        }
        
        // Phase 2: Project
        var dictionary = _projector.Project(request);
        // å¦‚æœ Project å¤±è´¥ï¼Œç«‹å³ç”Ÿæˆ NXC102
        
        // Phase 3: Execute
        var httpRequest = _signer.SignRequest(dictionary);
        var responseDict = await _transport.SendAsync(httpRequest, ct);
        // å¦‚æœ Execute å¤±è´¥ï¼Œç«‹å³ç”Ÿæˆ NXC3xx
        
        // Phase 4: Hydrate
        var response = _hydrator.Hydrate<TResponse>(responseDict);
        // å¦‚æœ Hydrate å¤±è´¥ï¼Œç«‹å³ç”Ÿæˆ NXC4xx
        
        return response;
    }
    catch (NexusException ex)
    {
        // NXC ç å¼‚å¸¸ç›´æ¥æŠ›å‡ºï¼Œä¸å…è®¸é‡æ–°åŒ…è£…æˆ–æ±‡æ€»
        throw;
    }
}
```

---

### III. é™æƒä¸ºç»†èŠ‚ï¼ˆDowngraded to Implementationï¼‰â€”â€” 4 é¡¹

è¿™äº›ä¸å†ä½œä¸ºæ¶æ„å†³ç­–ï¼Œè€Œæ˜¯ç¼–ç æŒ‡å—æˆ–å®ç°ç»†èŠ‚ï¼š

| åŸå§‹å†³ç­– | æ–°èº«ä»½ | ç†ç”± |
|---------|--------|------|
| GATEWAY-002 (ConfigureAwait) | .NET å¼€å‘è§„èŒƒ | å±äºå¼‚æ­¥ç¼–ç¨‹å¸¸è¯†ï¼Œæ— éœ€ ADR |
| RESOLVER-002 (SemaphoreSlim) | å¹¶å‘ç¼–ç¨‹ç»†èŠ‚ | å±äº HybridConfigResolver çš„å†…éƒ¨å®ç°ï¼Œä¸å½±å“ä¸»æƒ |
| CS-001 (L1/L2 ç»“æ„) | å­˜å‚¨æ–¹æ¡ˆå¿…ç„¶ | æ˜¯ Redis-First çš„è‡ªç„¶ç»“æœï¼Œä¸åº”å•ç‹¬å†³ç­– |
| MT-CONTEXT-003 (æµå¼ API) | è¯­æ³•ç³– | `ITenantIdentity` çš„æ„å»ºæ–¹å¼ï¼Œä¸å½±å“ç³»ç»Ÿèµ°å‘ |

---

## ğŸ“ ç¬¬ä¸‰éƒ¨åˆ†ï¼šç‰©ç†é‡æ„è“å›¾â€”â€”12 æ¡å®ªæ³•çš„æ‰§è¡Œç»†åˆ™

### å®ªæ³• 001ï¼šæ˜¾å¼å¥‘çº¦é”å®š

**ç‰©ç†çº¦æŸï¼š**
```csharp
// Contract å®šä¹‰å¿…é¡»åŒ…å«å®Œæ•´çš„å…ƒæ•°æ®
[NexusContract(Method = "alipay.trade.create")]
[ApiOperation("trade/create", HttpVerb.POST)]
public class TradeCreateRequest : IApiRequest<TradeCreateResponse>
{
    [ApiField("out_trade_no", IsRequired = true)]
    [Encrypt]  // æ ‡è®°éœ€è¦åŠ å¯†çš„å­—æ®µ
    public string OutTradeNo { get; set; }
}

// å¯åŠ¨æœŸæ£€æŸ¥ï¼šæ‰€æœ‰ Contract éƒ½èƒ½ç¼–è¯‘æˆ FrozenDictionary
// è¿è¡Œæ—¶ï¼šæ— åå°„ï¼Œæ‰€æœ‰è®¿é—®éƒ½èµ°ç¼–è¯‘æœŸ IL
```

---

### å®ªæ³• 002ï¼šURL èµ„æºå¯»å€

**ç‰©ç†çº¦æŸï¼š**
```
POST /merchants/{merchantId}/trade/pay

è·¯ç”±å‚æ•°ä¸¥æ ¼æ˜ å°„ï¼š
- {merchantId} â†’ profileIdï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
- API æ“ä½œ â†’ ä» Contract å…ƒæ•°æ®è¯»å–

ç¦æ­¢ï¼š
- âŒ ä» Body çŒœæµ‹èº«ä»½
- âŒ ä» Header é»˜è®¤è¡¥å…¨
- âŒ Query å‚æ•°å›é€€
```

**Endpoint æ ‡å‡†æ¨¡æ¿ï¼š**
```csharp
public sealed class TradePayEndpoint : NexusEndpoint<TradePayRequest>
{
    public override void Configure()
    {
        // è·¯ç”±æ˜¾å¼å®šä¹‰ ProfileId ä½ç½®
        Post("/merchants/{merchantId:guid}/trade/pay");
    }
    
    public override async Task HandleAsync(TradePayRequest req, CancellationToken ct)
    {
        // ä»è·¯ç”±å‚æ•°æ˜¾å¼æå–
        var merchantId = Route<Guid>("merchantId");
        
        // è½¬åŒ–ä¸º ProfileIdï¼ˆå¯ä»¥æ˜¯ GUID çš„ Base36 ç¼–ç ï¼‰
        var profileId = merchantId.ToString("N");
        
        var response = await _engine.ExecuteAsync(req, "Alipay", profileId, ct);
        await SendAsync(response);
    }
}
```

---

### å®ªæ³• 003ï¼šç‰©ç†æ§½ä½éš”ç¦»

**ç‰©ç†çº¦æŸï¼š**
```csharp
// Redis Key è®¾è®¡ï¼š
// Provider:ProfileId â†’ å”¯ä¸€ç‰©ç†æ§½ä½

string cacheKey = $"config:{providerName}:{profileId}";

// Realm é™çº§ä¸ºçº¯å®¡è®¡ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
// ä¸å‚ä¸å¯»å€é€»è¾‘

public interface IConfigurationResolver
{
    Task<IProviderConfiguration> ResolveAsync(
        string providerName,
        string profileId,
        CancellationToken ct);
    
    // Realm ä»…åœ¨å®¡è®¡æ¥å£ä¸­ä½¿ç”¨
    Task AuditAccessAsync(string realm, string profileId, string action);
}
```

---

### å®ªæ³• 004ï¼šBFF/Gate èŒè´£æ‹†åˆ†

**ç‰©ç†çº¦æŸï¼š**
```
BFF è´£ä»»ï¼ˆèº«ä»½è½¬æ¢ï¼‰ï¼š
  ç”¨æˆ·ä¿¡æ¯ + ä¸šåŠ¡å‚æ•° â†’ ProfileIdï¼ˆç¡®å®šæ€§è½¬æ¢ï¼‰
  
Gate è´£ä»»ï¼ˆæ‰§è¡Œï¼‰ï¼š
  ProfileId + Contract â†’ ç­¾å + HTTP è°ƒç”¨ + å“åº”å›å¡«
  
åˆ†ç•Œçº¿ï¼š
  BFF â†’ HTTP.Body:profileId + Contract â†’ Gate
  Gate â†’ Contract.Execute() â†’ HTTP.Response
```

**å®ç°ç¤ºä¾‹ï¼š**
```csharp
// BFF å±‚
public class MerchantBizService
{
    public async Task<TradePayResponse> PayAsync(Guid merchantId, PaymentDto dto)
    {
        // 1. èº«ä»½è½¬æ¢ï¼šmerchantId â†’ profileId
        var profileId = merchantId.ToString("N");
        
        // 2. ä¸šåŠ¡è½¬æ¢ï¼šPaymentDto â†’ TradePayRequest
        var request = new TradePayRequest
        {
            OutTradeNo = dto.OrderId,
            TotalAmount = dto.Amount,
            ProfileId = profileId  // â† æ˜¾å¼ä¼ é€’
        };
        
        // 3. è°ƒç”¨ Gate API
        var gateClient = new NexusGatewayClient(...);
        return await gateClient.SendAsync(request);
    }
}

// Gate å±‚
public sealed class TradePayEndpoint : NexusEndpoint<TradePayRequest>
{
    public override async Task HandleAsync(TradePayRequest req, CancellationToken ct)
    {
        // Gate åªå…³å¿ƒï¼šProfileId + Contract çš„æ‰§è¡Œ
        var response = await _engine.ExecuteAsync(req, "Alipay", req.ProfileId, ct);
        await SendAsync(response);
    }
}
```

---

### å®ªæ³• 005ï¼šçƒ­è·¯å¾„è„±ç½‘è‡ªæ²»

**ç‰©ç†çº¦æŸï¼š**
```csharp
// L1 ç¼“å­˜ç­–ç•¥ï¼ˆæç«¯æƒ…å†µï¼šRedis ç¦»çº¿ 30 å¤©ï¼‰
_memoryCache.Set(cacheKey, config, new MemoryCacheEntryOptions
{
    SlidingExpiration = TimeSpan.FromHours(24),           // çƒ­æ•°æ®
    AbsoluteExpirationRelativeToNow = TimeSpan.FromDays(30),  // å…œåº•
    Priority = CacheItemPriority.NeverRemove             // ç¦æ­¢é©±é€
});

// ä¸šåŠ¡å«ä¹‰ï¼š
// - åªè¦æµé‡ä¸åœï¼Œç¼“å­˜æ°¸è¿œæœ‰æ•ˆ
// - æ²¡æœ‰æµé‡è¶…è¿‡ 24 å°æ—¶ï¼Œç¼“å­˜è‡ªåŠ¨è¿‡æœŸ
// - Redis æ•…éšœæ—¶ï¼Œç³»ç»Ÿå¯ç»§ç»­è¿è¡Œ 30 å¤©ï¼ˆä¸æ˜¯"é™çº§"ï¼Œæ˜¯æ ‡å‡†è¡Œä¸ºï¼‰
```

---

### å®ªæ³• 006ï¼šå¯åŠ¨æœŸå…¨é‡ä½“æ£€

**ç‰©ç†çº¦æŸï¼š**
```csharp
// Program.csï¼šå¯åŠ¨å³åˆ»æ£€æŸ¥
var contractTypes = AppDomain.CurrentDomain.GetAssemblies()
    .SelectMany(a => a.GetTypes())
    .Where(t => t.GetCustomAttribute<ApiOperationAttribute>() != null)
    .ToArray();

var report = NexusContractMetadataRegistry.Instance.Preload(contractTypes, warmup: true);

if (report.HasCriticalErrors)
{
    Console.WriteLine("âŒ Startup failed - Contract errors detected");
    report.PrintDiagnostics();
    Environment.Exit(1);
}

// å¯åŠ¨æˆåŠŸ âŸº å®ªæ³• 007 çš„æ‰€æœ‰ IL ç¼–è¯‘å®Œæˆä¸”å¯é 
```

---

### å®ªæ³• 007ï¼šé›¶åå°„ IL å¼•æ“

**ç‰©ç†çº¦æŸï¼š**
```csharp
// Projection å’Œ Hydration éƒ½æ˜¯ç¼–è¯‘æœŸ IL
// è¿è¡Œæ—¶åªæœ‰æ–¹æ³•è°ƒç”¨ï¼Œé›¶åå°„

public class ILCompiledProjector
{
    // æ¯ä¸ª Contract ç¼–è¯‘ä¸€æ¬¡
    private readonly Func<TRequest, Dictionary<string, object>> _compiledProjector;
    
    public Dictionary<string, object> Project(TRequest request)
    {
        // çº¯æ–¹æ³•è°ƒç”¨ï¼Œæ— åå°„
        return _compiledProjector(request);
    }
}

public class ILCompiledHydrator
{
    private readonly Func<Dictionary<string, object>, TResponse> _compiledHydrator;
    
    public TResponse Hydrate(Dictionary<string, object> dict)
    {
        // çº¯æ–¹æ³•è°ƒç”¨ï¼Œæ— åå°„
        return _compiledHydrator(dict);
    }
}
```

---

### å®ªæ³• 008ï¼šå››é˜¶æ®µåŸå­ç®¡é“

**ç‰©ç†çº¦æŸï¼š**
```csharp
public async Task<TResponse> ExecuteAsync<TRequest, TResponse>(
    TRequest request,
    string providerName,
    string profileId,
    CancellationToken ct)
    where TRequest : IApiRequest<TResponse>
{
    // Phase 1: Validateï¼ˆå¯åŠ¨æœŸå·²å®Œæˆï¼Œè¿è¡Œæ—¶éªŒè¯ä¸šåŠ¡é€»è¾‘ï¼‰
    if (string.IsNullOrEmpty(request.OutTradeNo))
        throw new ContractValidationException("NXC101", "OutTradeNo required");
    
    // Phase 2: Project
    var dictionary = _projector.Project(request);
    
    // Phase 3: Execute
    var config = await _resolver.ResolveAsync(providerName, profileId, ct);
    var httpRequest = _signer.SignRequest(dictionary, config);
    var responseDict = await _transport.SendAsync(httpRequest, ct);
    
    // Phase 4: Hydrate
    var response = _hydrator.Hydrate<TResponse>(responseDict);
    
    return response;
}

// å…³é”®çº¦æŸï¼š
// - å„é˜¶æ®µç‹¬ç«‹å´©æºƒï¼ˆä¸çº§è”ï¼‰
// - é”™è¯¯ç«‹å³ç”Ÿæˆ NXC ç 
// - ä¸å…è®¸é˜¶æ®µé—´çŠ¶æ€å…±äº«
```

---

### å®ªæ³• 009 & 010ï¼šProvider åè®®ä¸»æƒä¸æ— çŠ¶æ€å•ä¾‹

**ç‰©ç†çº¦æŸï¼š**
```csharp
public interface IProvider
{
    string ProviderName { get; }
    
    /// <summary>
    /// ç»Ÿä¸€æ‰§è¡Œæ¥å£ï¼šé…ç½®ä»å‚æ•°ä¼ å…¥ï¼ˆæ— çŠ¶æ€ï¼‰
    /// </summary>
    Task<TResponse> ExecuteAsync<TResponse>(
        IApiRequest<TResponse> request,
        IProviderConfiguration config,
        CancellationToken ct)
        where TResponse : class, new();
}

// AlipayProvider æ˜¯å•ä¾‹ï¼ŒæœåŠ¡æ‰€æœ‰ ProfileId
public class AlipayProvider : IProvider
{
    private readonly INexusTransport _transport;
    private readonly ISigningService _signer;
    
    public async Task<TResponse> ExecuteAsync<TResponse>(
        IApiRequest<TResponse> request,
        IProviderConfiguration config,
        CancellationToken ct)
    {
        // é…ç½®ä»å‚æ•°è¯»å–ï¼Œä¸ä»å®ä¾‹å­—æ®µè¯»å–
        var signature = _signer.Sign(request, config.PrivateKey);
        var response = await _transport.SendAsync(...);
        return response;
    }
}

// æ³¨å†Œä¸ºå•ä¾‹ï¼ˆè€Œé Transientï¼‰
builder.Services.AddSingleton<IProvider>(new AlipayProvider(...));

// å¤š Provider æ³¨å†Œ
engine.RegisterProvider("Alipay", alipayProvider);
engine.RegisterProvider("WeChat", wechatProvider);
engine.RegisterProvider("UnionPay", unionPayProvider);
```

---

### å®ªæ³• 011ï¼šç‰ˆæœ¬åŒ–åŠ å¯†å­˜å‚¨

**ç‰©ç†çº¦æŸï¼š**
```csharp
// ç§é’¥åŠ å¯†æ ¼å¼ï¼šv1:base64_encrypted
// ç‰ˆæœ¬å‰ç¼€æ”¯æŒæœªæ¥å‡çº§ï¼ˆv2:, v3: ...ï¼‰

public class AesSecurityProvider : ISecurityProvider
{
    private readonly byte[] _masterKey;  // ç¯å¢ƒå˜é‡ SECURITY_MASTER_KEY
    
    public string EncryptPrivateKey(string plaintext)
    {
        using (var aes = Aes.Create())
        {
            aes.Key = _masterKey;
            aes.GenerateIV();
            
            var encrypted = Encrypt(plaintext, aes);
            var combined = aes.IV.Concat(encrypted).ToArray();
            var base64 = Convert.ToBase64String(combined);
            
            return $"v1:{base64}";  // â† ç‰ˆæœ¬å‰ç¼€
        }
    }
    
    public string DecryptPrivateKey(string encrypted)
    {
        var parts = encrypted.Split(':');
        var version = parts[0];  // v1, v2, ...
        var base64 = parts[1];
        
        // æ ¹æ®ç‰ˆæœ¬é€‰æ‹©ç®—æ³•
        if (version == "v1")
            return DecryptV1(base64);
        else if (version == "v2")
            return DecryptV2(base64);
        else
            throw new InvalidOperationException($"Unsupported version: {version}");
    }
}

// å­˜å‚¨åœ¨ Redisï¼š
// config:Alipay:merchant-001 = {
//   "ProviderName": "Alipay",
//   "AppId": "2021...",
//   "PrivateKey": "v1:aGVsbG8gd29ybGQ=...",  // â† åŠ å¯†å­˜å‚¨
//   "PublicKey": "MIIBIj...",
//   "GatewayUrl": "https://openapi.alipay.com/"
// }
```

---

### å®ªæ³• 012ï¼šNXC ç»“æ„åŒ–è¯Šæ–­

**ç‰©ç†çº¦æŸï¼š**
```csharp
// NXC ç çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ

public class ContractValidationException : NexusException
{
    public string NxcCode { get; }
    public DiagnosticData DiagnosticData { get; }
    
    public ContractValidationException(string nxcCode, object diagnosticData)
    {
        NxcCode = nxcCode;  // NXC101, NXC102, ...
        DiagnosticData = new DiagnosticData
        {
            Code = nxcCode,
            Timestamp = DateTime.UtcNow,
            Phase = "Validate",
            Details = diagnosticData
        };
    }
}

// å¼‚å¸¸åœ¨å‘ç”Ÿé˜¶æ®µç«‹å³ç”Ÿæˆ NXC ç 
try
{
    // Phase 1: Validate
    validator.Validate(request);
}
catch (ArgumentException ex)
{
    throw new ContractValidationException("NXC101", new { Field = "OutTradeNo", Error = ex.Message });
}

try
{
    // Phase 2: Project
    dictionary = projector.Project(request);
}
catch (InvalidCastException ex)
{
    throw new ProjectionException("NXC102", new { Type = typeof(TradePayRequest).Name, Error = ex.Message });
}

// HTTP å“åº”ä¸å¤„ç†å¼‚å¸¸ï¼Œç”± FastEndpoints å…¨å±€å¼‚å¸¸å¤„ç†å™¨è´Ÿè´£
// å…¨å±€å¤„ç†å™¨è¯»å– NxcCode å¹¶ç”Ÿæˆæ ‡å‡†çš„ NxcErrorEnvelope

public class NexusErrorHandler : IExceptionHandler
{
    public async ValueTask<bool> TryHandleAsync(
        HttpContext context,
        Exception exception,
        CancellationToken ct)
    {
        var nxcException = exception as NexusException 
            ?? throw new InvalidOperationException("Unknown exception type");
        
        context.Response.StatusCode = nxcException.HttpStatusCode;
        
        var envelope = new NxcErrorEnvelope
        {
            Code = nxcException.NxcCode,
            Message = nxcException.Message,
            DiagnosticData = nxcException.DiagnosticData,
            Timestamp = DateTime.UtcNow
        };
        
        await context.Response.WriteAsJsonAsync(envelope, cancellationToken: ct);
        return true;
    }
}
```

---

## ğŸ¯ ç¬¬å››éƒ¨åˆ†ï¼š137 â†’ 12 çš„å†³ç­–å½’å±è¡¨

### ä¿ç•™çš„ 12 æ¡å®ªæ³•å†³ç­–
âœ… ARCH-ISV-001, ARCH-ISV-002, ARCH-ISV-003, ARCH-ISV-004  
âœ… RESOLVER-001, RESOLVER-003  
âœ… PIPELINE-001, PIPELINE-002  
âœ… VALIDATE-001  
âœ… DIAG-001  
âœ… ROADMAP-001

### åˆ é™¤çš„ 6 é¡¹ï¼ˆç‰©ç†æŠ¹é™¤ï¼‰
âŒ ISO-001 (500ms è¶…æ—¶)  
âŒ ADAPT-HTTP-001 (å¤šæºèº«ä»½çŒœæµ‹)  
âŒ MULTIAPP-001 (é»˜è®¤ AppId å›é€€)  
âŒ CONFIG-MEMORY-003 (æ–‡ä»¶ç›‘æ§)  
âŒ HYDRATE-001 L2 (åå°„é™çº§)  
âŒ VER/CV ç³»åˆ— (ç®¡ç†å…«è‚¡)

### åˆå¹¶å…¥å®ªæ³•çš„ 25 é¡¹
**å®ªæ³• 001ï¼ˆæ˜¾å¼å¥‘çº¦é”å®šï¼‰ï¼š** CF-001, SD-001, HYDRATE-004, VALIDATE-002, NXC106  
**å®ªæ³• 002ï¼ˆURL å¯»å€ï¼‰ï¼š** DECOUPLE-002, ADAPT-HTTP-001, PIPELINE-003  
**å®ªæ³• 003ï¼ˆç‰©ç†éš”ç¦»ï¼‰ï¼š** ISO-003, MT-002, CONFIG-MEMORY-002, RESOLVER-005  
**å®ªæ³• 004ï¼ˆèŒè´£æ‹†åˆ†ï¼‰ï¼š** DECOUPLE-001, ADR-010, MT-001, MT-CONTEXT-001, ROADMAP-001  
**å®ªæ³• 005ï¼ˆè„±ç½‘è‡ªæ²»ï¼‰ï¼š** CS-002, CS-003, ADR-015, REDIS-001, RESOLVER-004  
**å®ªæ³• 006ï¼ˆå¯åŠ¨ä½“æ£€ï¼‰ï¼š** CF-003, DIAG-002, ROADMAP-002  
**å®ªæ³• 011ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰ï¼š** SD-003, SEC-AES-001, REDIS-003  
**å®ªæ³• 012ï¼ˆè¯Šæ–­ç ï¼‰ï¼š** GATEWAY-005

### é™æƒä¸ºç»†èŠ‚çš„ 4 é¡¹
ğŸ”· GATEWAY-002 (ConfigureAwait) â†’ .NET å¼€å‘è§„èŒƒ  
ğŸ”· RESOLVER-002 (SemaphoreSlim) â†’ å¹¶å‘ç¼–ç¨‹ç»†èŠ‚  
ğŸ”· CS-001 (L1/L2) â†’ å­˜å‚¨æ–¹æ¡ˆå¿…ç„¶  
ğŸ”· MT-CONTEXT-003 (æµå¼ API) â†’ è¯­æ³•ç³–

### æœªåˆ†ç±»çš„ 82 é¡¹ï¼ˆå¾…æ¸…ç†ï¼‰
è¿™äº›å†³ç­–è¦ä¹ˆæ˜¯**é‡å¤å†³ç­–**ï¼Œè¦ä¹ˆæ˜¯**æŸæ¡å®ªæ³•çš„å…·ä½“å®ä¾‹**ï¼Œéœ€è¦é€ä¸€å½’å¹¶ã€‚

---

## ğŸ“‹ ç¬¬äº”éƒ¨åˆ†ï¼š8 å‘¨å·¥ç¨‹æ‰§è¡Œè®¡åˆ’

### Week 1-2ï¼šåŸºç¡€è®¾æ–½æ¸…ç†
- [ ] ä»ä»£ç åº“åˆ é™¤ ISO-001, ADAPT-HTTP-001, MULTIAPP-001 ç›¸å…³ä»£ç 
- [ ] ä»ä»£ç åº“åˆ é™¤ CONFIG-MEMORY-003 (FileSystemWatcher)
- [ ] ä»ä»£ç åº“åˆ é™¤ HYDRATE-001 L2 (åå°„å›å¡«è·¯å¾„)
- [ ] ä»æ–‡æ¡£ä¸­åˆ é™¤ VER/CV ç³»åˆ—

### Week 3-4ï¼šé…ç½®å¯»å€é‡æ„
- [ ] æ”¹é€  `IConfigurationResolver` æ¥å£ï¼ˆProfileId å•å…ƒåŒ–ï¼‰
- [ ] æ”¹é€  `TenantContextFactory`ï¼ˆä»…æ”¯æŒ URL æ˜¾å¼æå–ï¼‰
- [ ] æ”¹é€  Redis Key è®¾è®¡ï¼ˆä¸‰å…ƒç»„ â†’ ProfileIdï¼‰
- [ ] æ›´æ–°æ‰€æœ‰ Endpointï¼ˆæ˜¾å¼è·¯ç”±å‚æ•°ï¼‰

### Week 5-6ï¼šå®ªæ³•æ‰§è¡Œ
- [ ] å®ç°å®ªæ³• 001-005ï¼ˆContract é”å®šã€URL å¯»å€ã€éš”ç¦»ã€èŒè´£æ‹†åˆ†ã€è„±ç½‘ï¼‰
- [ ] å®ç°å®ªæ³• 006-008ï¼ˆå¯åŠ¨ä½“æ£€ã€é›¶åå°„ã€å››é˜¶æ®µï¼‰
- [ ] å®ç°å®ªæ³• 009-010ï¼ˆProvider ä¸»æƒã€æ— çŠ¶æ€ï¼‰

### Week 7ï¼šå®‰å…¨ä¸è¯Šæ–­
- [ ] å®ç°å®ªæ³• 011ï¼ˆç‰ˆæœ¬åŒ–åŠ å¯†å­˜å‚¨ï¼‰
- [ ] å®ç°å®ªæ³• 012ï¼ˆNXC ç»“æ„åŒ–è¯Šæ–­ï¼‰
- [ ] ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼ˆNXC ç ç”Ÿæˆï¼‰

### Week 8ï¼šéªŒè¯ä¸æ¸…ç†
- [ ] æ›´æ–°æ‰€æœ‰å•å…ƒæµ‹è¯•ï¼ˆåˆ é™¤çš„é€»è¾‘ï¼‰
- [ ] åˆ é™¤ 137â†’12 è¿‡ç¨‹ä¸­çš„ä¸­é—´å†³ç­–æ–‡æ¡£
- [ ] ç”Ÿæˆ"æœˆæœˆçº¢"å®ªæ³•æœ€ç»ˆç¡®è®¤ç‰ˆæœ¬

---

## ğŸ æœ€ç»ˆäº§å‡º

**åˆ é™¤åçš„æ¸…æ´ä»£ç åº“ï¼š**
- âœ… é›¶åå°„ï¼Œé›¶çŒœæµ‹ï¼Œé›¶é™çº§
- âœ… æ˜¾å¼ä¼˜äºéšå¼
- âœ… 12 æ¡å®ªæ³•æ”¯æ’‘æ‰€æœ‰åŠŸèƒ½

**æœ€ç»ˆæ–‡æ¡£ï¼š**
- `CONSTITUTIONAL_FRAMEWORK.md` - 12 æ¡å®ªæ³•çš„ç‰©ç†çº¦æŸ
- `ARCHITECTURE_CLEAN.md` - åˆ é™¤æ±¡æŸ“é€»è¾‘åçš„æ¶æ„è“å›¾
- `ROADMAP_FINAL.md` - åç»­åŠŸèƒ½æ‰©å±•çš„å”¯ä¸€å‚è€ƒ

---

**æ‰§è¡Œè®¸å¯ï¼š** å¼€å§‹ Week 1 åŸºç¡€è®¾æ–½æ¸…ç†  
**é¢„æœŸå®Œæˆï¼š** 2026-02-28  
**éªŒæ”¶æ ‡å‡†ï¼š** æ‰€æœ‰å†³ç­–éƒ½èƒ½è¿½æº¯åˆ° 12 æ¡å®ªæ³•ä¹‹ä¸€

