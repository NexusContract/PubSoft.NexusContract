# ADR-001 入口/出口物理分离

**状态**: 提议
**日期**: 2026-01-11
**决策者**: 架构组
**相关**: `BLUEPRINT.md`

---

## 1. 上下文 (Context)
- **现状**: 系统同时承担外部代理入站与对下游的出站路由，职责边界不清。
- **痛点**: 路由、鉴权与链路责任混合，影响可测性与演进速度。

## 2. 决策 (Decision)
- **核心逻辑**: 将 Ingress（入口）与 Egress（出口）物理分离：Ingress 使用 FastEndpoints 处理入站请求，Egress 使用 YARP 绑定出口路由。
- **职责边界**: BFF/入口仅负责鉴权与路由决策；出口层负责与下游服务的网络交互与熔断策略。
- **寻址/存储**: 无特殊 Key 规则（实现层面继续沿用现有路由表）。

## 3. 理由 (Rationale)
- **业务收益**: 简化边界、减少跨层耦合、便于独立扩缩容与测试。
- **技术权衡**: 增加部署单元数量，但提升单元职责清晰度。

## 4. 影响与约束 (Impact)
- **副作用**: 需要调整路由配置与监控，发布时应验证端到端路径。
- **容错底线**: 出口层失效应有降级策略以避免影响入口层鉴权通路。
